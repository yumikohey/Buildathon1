{% extends 'base.html' %}

{% block title %}Home - Visual Memory Search{% endblock %}

{% block content %}
<div class="space-y-8">
    <!-- Hero Section -->
    <div class="text-center">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Visual Memory Search</h1>
        <p class="text-lg md:text-xl text-gray-600 mb-6 md:mb-8 px-4">Upload screenshots and search through them using natural language queries</p>
        
        <!-- Stats -->
        <div class="flex justify-center space-x-6 md:space-x-8 mb-6 md:mb-8">
            <div class="text-center">
                <div class="text-2xl md:text-3xl font-bold text-blue-600">{{ total_screenshots }}</div>
                <div class="text-xs md:text-sm text-gray-500">Screenshots</div>
            </div>
            <div class="text-center">
                <div class="text-2xl md:text-3xl font-bold text-yellow-600">{{ processing_count }}</div>
                <div class="text-xs md:text-sm text-gray-500">Processing</div>
            </div>
        </div>
    </div>
    
    <!-- Upload Section -->
    <div class="bg-white rounded-lg shadow-sm p-4 md:p-6">
        <h2 class="text-xl md:text-2xl font-semibold text-gray-900 mb-3 md:mb-4">Upload Screenshots</h2>
        <p class="text-sm md:text-base text-gray-600 mb-4 md:mb-6">Drag and drop your screenshots here or tap to select files. Supported formats: PNG, JPG, JPEG, GIF (max 10MB each)</p>
        
        <!-- Upload Form -->
        <form id="screenshot-upload" class="dropzone" action="{% url 'screenshots:upload' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="dz-message text-center py-8 md:py-12">
                <div class="mb-3 md:mb-4">
                    <svg class="mx-auto h-10 w-10 md:h-12 md:w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                        <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>
                <div class="text-base md:text-lg font-medium text-gray-900 mb-1">Drop screenshots or folders here</div>
                <div class="text-sm text-gray-500">or tap to browse files/folders</div>
            </div>
        </form>
        
        <!-- Mobile-Optimized Upload Buttons -->
        <div class="mt-4 flex flex-col sm:flex-row gap-3 sm:justify-center">
            <button id="folder-upload-btn" class="flex items-center justify-center px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors touch-manipulation">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-5l-2-2H5a2 2 0 00-2 2z"></path>
                </svg>
                Upload Folder
            </button>
            <button id="single-file-btn" class="flex items-center justify-center px-6 py-3 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors touch-manipulation">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                Select Files
            </button>
            <input type="file" id="folder-input" webkitdirectory directory multiple style="display: none;">
            <input type="file" id="file-input" multiple accept="image/*" style="display: none;">
        </div>
        
        <!-- Upload Results -->
        <div id="upload-results" class="mt-6 hidden">
            <h3 class="text-lg font-medium text-gray-900 mb-4">Upload Results</h3>
            <div id="upload-success" class="space-y-2"></div>
            <div id="upload-errors" class="space-y-2"></div>
        </div>
    </div>
    
    <!-- Quick Search -->
    <div class="bg-white rounded-lg shadow-sm p-6">
        <h2 class="text-2xl font-semibold text-gray-900 mb-4">Quick Search</h2>
        <form action="{% url 'screenshots:search' %}" method="get" class="flex space-x-4">
            <input type="text" name="q" placeholder="Search screenshots with natural language..." 
                   class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                Search
            </button>
        </form>
        
        <!-- Example queries -->
        <div class="mt-4">
            <p class="text-sm text-gray-500 mb-2">Try searching for:</p>
            <div class="flex flex-wrap gap-2">
                <a href="{% url 'screenshots:search' %}?q=login+form" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200">"login form"</a>
                <a href="{% url 'screenshots:search' %}?q=blue+button" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200">"blue button"</a>
                <a href="{% url 'screenshots:search' %}?q=error+message" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200">"error message"</a>
                <a href="{% url 'screenshots:search' %}?q=navigation+menu" class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200">"navigation menu"</a>
            </div>
        </div>
    </div>
    
    <!-- Recent Screenshots -->
    {% if recent_screenshots %}
    <div class="bg-white rounded-lg shadow-sm p-6">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-semibold text-gray-900">Recent Screenshots</h2>
            <a href="{% url 'screenshots:gallery' %}" class="text-blue-600 hover:text-blue-700 font-medium">View All â†’</a>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for screenshot in recent_screenshots %}
            <div class="bg-gray-50 rounded-lg overflow-hidden hover:shadow-md transition-shadow" data-screenshot-id="{{ screenshot.id }}">
                <a href="{% url 'screenshots:detail' screenshot.id %}">
                    <div class="aspect-video bg-gray-200 flex items-center justify-center">
                        {% if screenshot.image %}
                            <img src="{{ screenshot.image.url }}" alt="{{ screenshot.filename }}" 
                                 class="max-w-full max-h-full object-contain">
                        {% else %}
                            <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        {% endif %}
                    </div>
                </a>
                
                <div class="p-4">
                    <h3 class="font-medium text-gray-900 truncate mb-2">{{ screenshot.filename }}</h3>
                    
                    <!-- Processing Status -->
                    <div class="flex items-center space-x-2 mb-2 status-badge">
                        {% if screenshot.processing_status == 'completed' %}
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                </svg>
                                Processed
                            </span>
                        {% elif screenshot.processing_status == 'processing' %}
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                <svg class="w-3 h-3 mr-1 processing-spinner" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                Processing
                            </span>
                        {% elif screenshot.processing_status == 'failed' %}
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                                </svg>
                                Failed
                            </span>
                        {% else %}
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                Pending
                            </span>
                        {% endif %}
                    </div>
                    
                    <div class="text-sm text-gray-500">
                        <div>{{ screenshot.file_size_mb }} MB</div>
                        <div>{{ screenshot.uploaded_at|date:"M d, Y H:i" }}</div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_css %}
<style>
    /* Processing spinner animation */
    .processing-spinner {
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }
    
    /* Progress notification styles */
    .progress-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        max-width: 300px;
        animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    /* Status badge transition effects */
    .status-badge {
        transition: all 0.3s ease;
    }
    
    .status-badge span {
        transition: all 0.2s ease;
    }
    
    /* Pulse effect for processing items */
    .processing-pulse {
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0%, 100% {
            opacity: 1;
        }
        50% {
            opacity: 0.7;
        }
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    // Configure Dropzone
    Dropzone.autoDiscover = false;
    
    const uploadDropzone = new Dropzone("#screenshot-upload", {
        url: "{% url 'screenshots:upload' %}",
        paramName: "file",
        maxFilesize: 10, // MB
        acceptedFiles: "image/*",
        addRemoveLinks: true,
        parallelUploads: 5, // Process multiple files simultaneously
        dictDefaultMessage: "Drop screenshots or folders here or click to browse",
        dictFallbackMessage: "Your browser does not support drag and drop file uploads.",
        dictFileTooBig: "File is too big ({{filesize}}MB). Max filesize: {{maxFilesize}}MB.",
        dictInvalidFileType: "You can't upload files of this type.",
        dictResponseError: "Server responded with {{statusCode}} code.",
        dictCancelUpload: "Cancel upload",
        dictRemoveFile: "Remove file",
        dictMaxFilesExceeded: "You can not upload any more files.",
        
        init: function() {
            this.on("success", function(file, response) {
                console.log("Upload success:", response);
                showUploadResults(response);
            });
            
            this.on("error", function(file, errorMessage) {
                console.error("Upload error:", errorMessage);
            });
            
            this.on("complete", function(file) {
                // Auto-remove file after upload
                setTimeout(() => {
                    this.removeFile(file);
                }, 2000);
            });
            
            this.on("sending", function(file, xhr, formData) {
                // Add file metadata for timestamp extraction
                if (file.lastModified) {
                    formData.append('file_last_modified', file.lastModified);
                }
                if (file.lastModifiedDate) {
                    formData.append('file_last_modified_date', file.lastModifiedDate.toISOString());
                }
                console.log('Sending file:', file.name, 'Last modified:', file.lastModified);
            });
            
            // Handle folder drops
            this.on("drop", function(e) {
                if (e.dataTransfer.items) {
                    handleFolderDrop(e.dataTransfer.items, this);
                }
            });
        }
    });
    
    // Folder upload button handler
    document.getElementById('folder-upload-btn').addEventListener('click', function() {
        document.getElementById('folder-input').click();
    });
    
    // Single file upload button handler
    document.getElementById('single-file-btn').addEventListener('click', function() {
        document.getElementById('file-input').click();
    });
    
    // Handle folder input change
    document.getElementById('folder-input').addEventListener('change', function(e) {
        const files = Array.from(e.target.files);
        const imageFiles = files.filter(file => file.type.startsWith('image/'));
        
        if (imageFiles.length > 0) {
            console.log(`Processing ${imageFiles.length} images from folder`);
            imageFiles.forEach(file => {
                // Add file path information
                file.fullPath = file.webkitRelativePath || file.name;
                // Add file metadata for timestamp extraction
                file.lastModifiedDate = new Date(file.lastModified);
                uploadDropzone.addFile(file);
            });
        } else {
            alert('No image files found in the selected folder.');
        }
    });
    
    // Handle single file input change
    document.getElementById('file-input').addEventListener('change', function(e) {
        const files = Array.from(e.target.files);
        const imageFiles = files.filter(file => file.type.startsWith('image/'));
        
        if (imageFiles.length > 0) {
            console.log(`Processing ${imageFiles.length} selected images`);
            imageFiles.forEach(file => {
                // Add file metadata for timestamp extraction
                file.lastModifiedDate = new Date(file.lastModified);
                uploadDropzone.addFile(file);
            });
        } else {
            alert('No image files selected.');
        }
    });
    
    // Handle folder drop functionality
    async function handleFolderDrop(items, dropzone) {
        const files = [];
        
        for (let i = 0; i < items.length; i++) {
            const item = items[i];
            if (item.kind === 'file') {
                const entry = item.webkitGetAsEntry();
                if (entry) {
                    await traverseFileTree(entry, files);
                }
            }
        }
        
        const imageFiles = files.filter(file => file.type.startsWith('image/'));
        if (imageFiles.length > 0) {
            console.log(`Processing ${imageFiles.length} images from dropped folder`);
            imageFiles.forEach(file => {
                // Add file metadata for timestamp extraction
                file.lastModifiedDate = new Date(file.lastModified);
                dropzone.addFile(file);
            });
        }
    }
    
    // Recursively traverse folder structure
    function traverseFileTree(item, files) {
        return new Promise((resolve) => {
            if (item.isFile) {
                item.file(function(file) {
                    file.fullPath = item.fullPath;
                    // Add file metadata for timestamp extraction
                    file.lastModifiedDate = new Date(file.lastModified);
                    files.push(file);
                    resolve();
                });
            } else if (item.isDirectory) {
                const dirReader = item.createReader();
                dirReader.readEntries(async function(entries) {
                    for (let entry of entries) {
                        await traverseFileTree(entry, files);
                    }
                    resolve();
                });
            } else {
                resolve();
            }
        });
    }
    
    function showUploadResults(response) {
        const resultsDiv = document.getElementById('upload-results');
        const successDiv = document.getElementById('upload-success');
        const errorsDiv = document.getElementById('upload-errors');
        
        resultsDiv.classList.remove('hidden');
        
        // Show successful uploads
        if (response.uploaded && response.uploaded.length > 0) {
            successDiv.innerHTML = '';
            response.uploaded.forEach(file => {
                const div = document.createElement('div');
                div.className = 'flex items-center p-3 bg-green-50 border border-green-200 rounded-lg';
                div.innerHTML = `
                    <svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="text-green-800">${file.filename} uploaded successfully and queued for processing</span>
                `;
                successDiv.appendChild(div);
            });
        }
        
        // Show errors
        if (response.errors && response.errors.length > 0) {
            errorsDiv.innerHTML = '';
            response.errors.forEach(error => {
                const div = document.createElement('div');
                div.className = 'flex items-center p-3 bg-red-50 border border-red-200 rounded-lg';
                div.innerHTML = `
                    <svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="text-red-800">${error}</span>
                `;
                errorsDiv.appendChild(div);
            });
        }
        
        // Auto-hide results after 10 seconds
        setTimeout(() => {
            resultsDiv.classList.add('hidden');
        }, 10000);
        
        // Start polling for processing status updates
        startProcessingStatusPolling();
    }
    
    // Processing status polling functionality
    let pollingInterval;
    let isPolling = false;
    
    function startProcessingStatusPolling() {
        if (isPolling) return;
        
        isPolling = true;
        pollingInterval = setInterval(updateProcessingStatus, 3000); // Poll every 3 seconds
        
        // Also update immediately
        updateProcessingStatus();
    }
    
    function stopProcessingStatusPolling() {
        if (pollingInterval) {
            clearInterval(pollingInterval);
            pollingInterval = null;
        }
        isPolling = false;
    }
    
    async function updateProcessingStatus() {
        try {
            const response = await fetch('{% url "screenshots:processing_status" %}');
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            
            // Update the processing count in the stats section
            const processingCountElement = document.querySelector('.text-yellow-600');
            if (processingCountElement) {
                processingCountElement.textContent = data.processing_count;
            }
            
            // Update total screenshots count
            const totalCountElement = document.querySelector('.text-blue-600');
            if (totalCountElement) {
                totalCountElement.textContent = data.total_screenshots;
            }
            
            // Update individual screenshot status badges
            updateScreenshotStatusBadges(data.screenshots);
            
            // Show progress notification if there are processing screenshots
            if (data.processing_count > 0) {
                showProcessingNotification(data.processing_count, data.total_screenshots);
            } else {
                hideProcessingNotification();
            }
            
            // Stop polling if no screenshots are processing
            if (data.processing_count === 0 && data.pending_count === 0) {
                // Wait a bit more to ensure all processing is complete
                setTimeout(() => {
                    if (data.processing_count === 0 && data.pending_count === 0) {
                        stopProcessingStatusPolling();
                    }
                }, 5000);
            }
            
        } catch (error) {
            console.error('Error updating processing status:', error);
        }
    }
    
    function updateScreenshotStatusBadges(screenshots) {
        screenshots.forEach(screenshot => {
            const statusElement = document.querySelector(`[data-screenshot-id="${screenshot.id}"] .status-badge`);
            if (statusElement) {
                updateStatusBadge(statusElement, screenshot.processing_status);
            }
        });
    }
    
    function updateStatusBadge(element, status) {
        // Remove existing classes
        element.className = 'inline-flex items-center px-2 py-1 rounded-full text-xs font-medium status-badge';
        
        let content = '';
        
        if (status === 'completed') {
            element.classList.add('bg-green-100', 'text-green-800');
            content = `
                <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                </svg>
                Processed
            `;
        } else if (status === 'processing') {
            element.classList.add('bg-yellow-100', 'text-yellow-800');
            content = `
                <svg class="w-3 h-3 mr-1 processing-spinner" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                Processing
            `;
        } else if (status === 'failed') {
            element.classList.add('bg-red-100', 'text-red-800');
            content = `
                <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                </svg>
                Failed
            `;
        } else {
            element.classList.add('bg-gray-100', 'text-gray-800');
            content = 'Pending';
        }
        
        element.innerHTML = content;
    }
    
    function showProcessingNotification(processingCount, totalCount) {
        let notification = document.getElementById('processing-notification');
        
        if (!notification) {
            notification = document.createElement('div');
            notification.id = 'processing-notification';
            notification.className = 'fixed top-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 flex items-center space-x-2';
            document.body.appendChild(notification);
        }
        
        const percentage = Math.round(((totalCount - processingCount) / totalCount) * 100);
        
        notification.innerHTML = `
            <svg class="w-4 h-4 processing-spinner" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
            </svg>
            <span>Processing ${processingCount} screenshots... ${percentage}% complete</span>
        `;
        
        notification.style.display = 'flex';
    }
    
    function hideProcessingNotification() {
        const notification = document.getElementById('processing-notification');
        if (notification) {
            notification.style.display = 'none';
        }
    }
    
    // Start polling when page loads
    document.addEventListener('DOMContentLoaded', function() {
        startProcessingStatusPolling();
    });
    
    // Stop polling when page is hidden/unloaded
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            stopProcessingStatusPolling();
        } else {
            startProcessingStatusPolling();
        }
    });
    
    window.addEventListener('beforeunload', function() {
        stopProcessingStatusPolling();
    });
</script>

<style>
    .processing-spinner {
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }
    
    #processing-notification {
        transition: all 0.3s ease-in-out;
    }
</style>

{% endblock %}